<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Activity & Internship Recommendations - Path Pal">
  <title>Activity & Internship Recs - Path Pal</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/css/style.css">
  <meta name="theme-color" content="#0d8c79">
</head>
<body>
  <div class="desktop-message">
    <h1><img src="/media/icons/Mobile256x256.png" alt="Mobile" style="width: 48px; height: 48px; vertical-align: middle; margin-right: 0.5rem;"> Mobile App Required</h1>
    <p>Path Pal is designed for mobile devices. Please open this site on your mobile phone or tablet.</p>
  </div>

  <header>
    <div class="header-content container">
      <div class="logo">
        <a href="/index.html" style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none; color: inherit;">
          <img src="/media/logo/logo64x64.png" alt="Path Pal Logo">
          <h1>Path Pal</h1>
        </a>
      </div>
      <button class="menu-toggle" aria-label="Toggle menu"><img src="/media/icons/Hamburger128x128.png" alt="Menu" style="width: 24px; height: 24px;"></button>
    </div>
  </header>

  <nav>
    <ul>
      <li><a href="/index.html"><img src="/media/icons/Home256x256.png" alt="Home" class="nav-icon"> Home</a></li>
      <li><a href="/profile.html"><img src="/media/icons/Profile256x256.png" alt="Profile" class="nav-icon"> My Profile</a></li>
      <li><a href="/odds.html"><img src="/media/icons/Odds256x256.png" alt="Admissions Odds" class="nav-icon"> Admissions Odds</a></li>
      <li><a href="/simulator.html"><img src="/media/icons/Book256x256.png" alt="What If" class="nav-icon"> "What If" Simulator</a></li>
      <li><a href="/explorer.html"><img src="/media/icons/Search256x256.png" alt="College Explorer" class="nav-icon"> College Explorer</a></li>
      <li><a href="/career.html"><img src="/media/icons/DollarSign256x256.png" alt="Career & Salary Paths" class="nav-icon"> Career & Salary Paths</a></li>
      <li><a href="/activities.html" class="active"><img src="/media/icons/Activity256x256.png" alt="Activities" class="nav-icon"> Activity & Internship Recs</a></li>
      <li><a href="/planner.html"><img src="/media/icons/Calender256x256.png" alt="4-Year Planner" class="nav-icon"> 4-Year Planner</a></li>
      <li><a href="/messages.html"><img src="/media/icons/Chat256x256.png" alt="AI Counselor" class="nav-icon"> AI Counselor</a></li>
      <li><a href="/saved.html"><img src="/media/icons/Star256x256.png" alt="Saved Colleges" class="nav-icon"> Saved Colleges</a></li>
    </ul>
  </nav>

  <main>
    <div class="container">
      <h2 style="color: var(--primary-green); margin: 1rem 0;">Activity & Internship Recommendations</h2>

      <!-- Filters -->
      <div class="filters">
        <h3 style="color: var(--primary-green); margin-bottom: 1rem;">Filter by Category</h3>
        <div class="filters-grid">
          <button class="btn filter-btn active" data-category="all" onclick="filterActivities('all')">
            All
          </button>
          <button class="btn filter-btn" data-category="academic" onclick="filterActivities('academic')">
            Academic
          </button>
          <button class="btn filter-btn" data-category="leadership" onclick="filterActivities('leadership')">
            Leadership
          </button>
          <button class="btn filter-btn" data-category="community" onclick="filterActivities('community')">
            Community Service
          </button>
          <button class="btn filter-btn" data-category="career" onclick="filterActivities('career')">
            Career-Focused
          </button>
          <button class="btn filter-btn" data-category="internship" onclick="filterActivities('internship')">
            Internships
          </button>
        </div>
      </div>

      <!-- Recommendations -->
      <div class="card">
        <h3>Personalized Recommendations</h3>
        <p style="margin-bottom: 1rem;">Based on your profile and goals, here are activities and internships that can strengthen your college application. Filter by category to find opportunities that match your interests.</p>
        <button class="btn btn-secondary" onclick="loadRecommendations()" style="width: 100%;">
          Refresh Recommendations
        </button>
      </div>

      <!-- Activity List -->
      <div id="activities-list"></div>

      <!-- Saved Activities -->
      <div class="card" id="saved-activities" style="display: none;">
        <h3>Saved Activities</h3>
        <div id="saved-list"></div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 Path Pal. v1.07</p>
    </div>
  </footer>

  <script src="/js/api.js"></script>
  <script src="/js/app.js"></script>
  <script>
    let allActivities = [];
    let currentFilter = 'all';

    const defaultActivities = [
      // Academic
      { id: 1, title: 'Math Olympiad / Math Team', category: 'academic', description: 'Competitive math problem-solving team. Develops analytical thinking and problem-solving skills.', platform: 'School-based', timeCommitment: '2-4 hrs/week', gradeLevel: '9-12' },
      { id: 2, title: 'Science Olympiad', category: 'academic', description: 'Competitive science team covering various STEM disciplines. Great for students interested in science.', platform: 'School-based', timeCommitment: '3-5 hrs/week', gradeLevel: '9-12' },
      { id: 3, title: 'Debate Team / Model UN', category: 'academic', description: 'Develops public speaking, research, and critical thinking skills through competitive debate or Model United Nations.', platform: 'School-based', timeCommitment: '3-6 hrs/week', gradeLevel: '9-12' },
      { id: 4, title: 'Academic Research Project', category: 'academic', description: 'Independent research project with a mentor. Can be in any field - science, humanities, social sciences.', platform: 'University/Research Program', timeCommitment: '5-10 hrs/week', gradeLevel: '10-12' },
      { id: 5, title: 'Honor Society', category: 'academic', description: 'National Honor Society or subject-specific honor societies. Recognizes academic excellence and service.', platform: 'School-based', timeCommitment: '1-3 hrs/week', gradeLevel: '10-12' },
      
      // Leadership
      { id: 6, title: 'Student Government / ASB', category: 'leadership', description: 'Elected position representing student body. Develops leadership, communication, and organizational skills.', platform: 'School-based', timeCommitment: '5-8 hrs/week', gradeLevel: '9-12' },
      { id: 7, title: 'Club President / Founder', category: 'leadership', description: 'Start or lead a club related to your interests. Shows initiative and leadership ability.', platform: 'School-based', timeCommitment: '3-5 hrs/week', gradeLevel: '9-12' },
      { id: 8, title: 'Peer Tutor / Mentor', category: 'leadership', description: 'Help other students succeed academically. Develops teaching and communication skills.', platform: 'School-based', timeCommitment: '2-4 hrs/week', gradeLevel: '10-12' },
      { id: 9, title: 'Sports Team Captain', category: 'leadership', description: 'Lead a sports team. Demonstrates teamwork, dedication, and leadership.', platform: 'School-based', timeCommitment: '10-15 hrs/week', gradeLevel: '10-12' },
      
      // Community Service
      { id: 10, title: 'Volunteer Tutoring', category: 'community', description: 'Tutor underprivileged students in your community. Make a meaningful impact while developing teaching skills.', platform: 'Local Organization', timeCommitment: '2-4 hrs/week', gradeLevel: '9-12' },
      { id: 11, title: 'Food Bank / Soup Kitchen Volunteer', category: 'community', description: 'Help fight hunger in your community. Regular volunteering shows commitment to service.', platform: 'Local Non-profit', timeCommitment: '2-4 hrs/week', gradeLevel: '9-12' },
      { id: 12, title: 'Environmental Cleanup / Conservation', category: 'community', description: 'Participate in environmental conservation efforts. Great for students interested in sustainability.', platform: 'Environmental Organization', timeCommitment: '2-5 hrs/week', gradeLevel: '9-12' },
      { id: 13, title: 'Hospital / Healthcare Volunteer', category: 'community', description: 'Volunteer at a local hospital or healthcare facility. Excellent for pre-med students.', platform: 'Hospital/Clinic', timeCommitment: '3-6 hrs/week', gradeLevel: '10-12' },
      { id: 14, title: 'Animal Shelter Volunteer', category: 'community', description: 'Help care for animals at a local shelter. Shows compassion and responsibility.', platform: 'Animal Shelter', timeCommitment: '2-4 hrs/week', gradeLevel: '9-12' },
      
      // Career-Focused
      { id: 15, title: 'Business Pitch Competition', category: 'career', description: 'Develop and pitch business ideas in competitions. Great for entrepreneurship-minded students.', platform: 'Competition/Program', timeCommitment: '5-10 hrs/week (seasonal)', gradeLevel: '10-12' },
      { id: 16, title: 'Coding Bootcamp / Tech Program', category: 'career', description: 'Intensive programming or tech skills course. Develops technical skills for tech careers.', platform: 'Online/Local Program', timeCommitment: '10-20 hrs/week (intensive)', gradeLevel: '9-12' },
      { id: 17, title: 'Journalism / School Newspaper', category: 'career', description: 'Write for school newspaper or journalism program. Develops writing and communication skills.', platform: 'School-based', timeCommitment: '3-5 hrs/week', gradeLevel: '9-12' },
      { id: 18, title: 'Robotics Team', category: 'career', description: 'Build and program robots for competitions. Combines engineering, programming, and teamwork.', platform: 'School/Community Team', timeCommitment: '5-10 hrs/week', gradeLevel: '9-12' },
      
      // Internships
      { id: 19, title: 'Summer Internship', category: 'internship', description: 'Gain real-world work experience in your field of interest. Highly valued by colleges.', platform: 'Various', timeCommitment: '20-40 hrs/week (summer)', gradeLevel: '11-12' },
      { id: 20, title: 'Research Internship', category: 'internship', description: 'Work with professors or researchers on ongoing projects. Great for STEM students.', platform: 'University/Research Lab', timeCommitment: '15-30 hrs/week (summer)', gradeLevel: '11-12' },
      { id: 21, title: 'Shadowing Program', category: 'internship', description: 'Shadow professionals in your field of interest. Learn about careers firsthand.', platform: 'Professional Networks', timeCommitment: '5-10 hrs/week', gradeLevel: '10-12' }
    ];

    document.addEventListener('DOMContentLoaded', () => {
      loadRecommendations();
      loadSavedActivities();
    });

    async function loadRecommendations() {
      const profile = await UserProfile.get();
      const container = document.getElementById('activities-list');
      
      // Show loading state
      container.innerHTML = '<div class="card"><p class="loading">Loading recommendations...</p></div>';
      
      // Start with default activities
      allActivities = [...defaultActivities];

      try {
        // Get AI recommendations if profile has enough info
        if (profile.majors && profile.majors.length > 0) {
          const message = `Based on my profile (Grade: ${profile.grade || 'not set'}, Majors: ${(profile.majors || []).join(', ') || 'not specified'}, Career Goals: ${profile.careerGoals || 'not specified'}), suggest 3-5 specific extracurricular activities, clubs, volunteer opportunities, or internships that would strengthen my college application. Format as a numbered list with brief descriptions.`;
          
          const response = await sendChatMessage(message);
          const recommendations = response.message.split('\n').filter(line => line.trim() && /^\d+[.)]/.test(line.trim()));
          
          // Add AI recommendations
          const aiActivities = recommendations.map((rec, idx) => {
            const text = rec.replace(/^\d+[.)]\s*/, '').trim();
            const parts = text.split(':');
            return {
              id: defaultActivities.length + idx + 1,
              title: parts[0].trim(),
              description: parts.slice(1).join(':').trim() || 'Personalized recommendation based on your profile',
              category: 'career',
              platform: 'AI Recommended',
              timeCommitment: 'Varies',
              gradeLevel: profile.grade || '9-12'
            };
          });
          
          allActivities = [...defaultActivities, ...aiActivities];
        }
      } catch (error) {
        console.error('Error loading AI recommendations:', error);
        // Continue with default activities
      }

      displayActivities(allActivities);
    }

    function displayActivities(activities) {
      const container = document.getElementById('activities-list');
      const filtered = currentFilter === 'all' ? activities : activities.filter(a => a.category === currentFilter);

      if (filtered.length === 0) {
        container.innerHTML = `
          <div class="card" style="text-align: center; padding: 2rem;">
            <h4 style="color: var(--primary-green); margin-bottom: 1rem;">No Activities Found</h4>
            <p style="color: var(--text-light); margin-bottom: 1rem;">No activities match your current filter. Try selecting a different category.</p>
            <button class="btn btn-secondary" onclick="filterActivities('all')">Show All Activities</button>
          </div>
        `;
        return;
      }

      container.innerHTML = '<h3 style="color: var(--primary-green); margin: 1rem 0;">Recommended Activities</h3>';

      filtered.forEach(activity => {
        const card = document.createElement('div');
        card.className = 'card';
        card.style.marginBottom = '1rem';
        
        const categoryLabels = {
          academic: 'Academic',
          leadership: 'Leadership',
          community: 'Community Service',
          career: 'Career-Focused',
          internship: 'Internship'
        };
        
        card.innerHTML = `
          <div style="margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
              <div style="flex: 1;">
                <h4 style="color: var(--primary-green); margin-bottom: 0.5rem;">${activity.title}</h4>
                <p style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 0.75rem; line-height: 1.5;">${activity.description || 'No description available'}</p>
                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                  <span class="badge badge-target" style="background: var(--light-mint); color: var(--primary-green);">
                    ${categoryLabels[activity.category] || activity.category}
                  </span>
                  ${activity.timeCommitment ? `<span style="color: var(--text-light); font-size: 0.85rem; display: flex; align-items: center; gap: 0.25rem;"><img src="/media/icons/HourGlass176x256.png" alt="Time" style="width: 14px; height: 14px;"> ${activity.timeCommitment}</span>` : ''}
                  ${activity.platform ? `<span style="color: var(--text-light); font-size: 0.85rem; display: flex; align-items: center; gap: 0.25rem;"><img src="/media/icons/Location128x128.png" alt="Location" style="width: 14px; height: 14px;"> ${activity.platform}</span>` : ''}
                  ${activity.gradeLevel ? `<span style="color: var(--text-light); font-size: 0.85rem; display: flex; align-items: center; gap: 0.25rem;"><img src="/media/icons/Book256x256.png" alt="Grade" style="width: 14px; height: 14px;"> Grades ${activity.gradeLevel}</span>` : ''}
                </div>
              </div>
            </div>
          </div>
          <div style="display: flex; gap: 0.5rem;">
            <button class="btn btn-secondary" onclick="askCounselorAboutActivity('${activity.title}', '${activity.description || ''}')" style="flex: 1; display: flex; align-items: center; justify-content: center; gap: 0.5rem; background: var(--light-mint); color: var(--primary-green);">
              <img src="/media/icons/Chat256x256.png" alt="Counselor" style="width: 16px; height: 16px;"> Counselor
            </button>
            <button class="btn btn-secondary" onclick="addToPlanner(${activity.id})" style="flex: 1; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
              <img src="/media/icons/Calender256x256.png" alt="Calendar" style="width: 16px; height: 16px;"> Add to Planner
            </button>
          </div>
        `;
        
        container.appendChild(card);
      });
    }

    function filterActivities(category) {
      currentFilter = category;
      
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.category === category) {
          btn.classList.add('active');
        }
      });
      
      displayActivities(allActivities);
    }

    function askCounselorAboutActivity(activityTitle, activityDescription) {
      // Create a question about the activity
      const question = `Tell me more about "${activityTitle}"${activityDescription ? `: ${activityDescription}` : ''}. How can this activity help strengthen my college application? What should I know about getting involved?`;
      
      // Navigate to AI counselor with the question as a URL parameter
      const encodedQuestion = encodeURIComponent(question);
      window.location.href = `/messages.html?question=${encodedQuestion}`;
    }

    function addToPlanner(activityId) {
      const activity = allActivities.find(a => a.id === activityId);
      if (activity) {
        const plannerItems = Storage.get('plannerItems', []);
        // Check if already added
        if (plannerItems.find(item => item.id === activityId)) {
          showNotification(`${activity.title} is already in your planner.`, 'info');
          return;
        }
        plannerItems.push({ ...activity, addedAt: new Date().toISOString() });
        Storage.set('plannerItems', plannerItems);
        showNotification(`${activity.title} added to 4-Year Planner!`, 'success');
      }
    }

    function loadSavedActivities() {
      const saved = Storage.get('savedActivities', []);
      const container = document.getElementById('saved-activities');
      const listContainer = document.getElementById('saved-list');

      if (saved.length === 0) {
        container.style.display = 'none';
        return;
      }

      container.style.display = 'block';
      const categoryLabels = {
        academic: 'Academic',
        leadership: 'Leadership',
        community: 'Community Service',
        career: 'Career-Focused',
        internship: 'Internship'
      };
      
      listContainer.innerHTML = saved.map(activity => `
        <div style="background: var(--light-mint); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--primary-green);">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
            <div style="flex: 1;">
              <h4 style="color: var(--primary-green); margin-bottom: 0.5rem;">${activity.title}</h4>
              <p style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 0.5rem; line-height: 1.5;">${activity.description || 'No description'}</p>
              <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center;">
                <span class="badge badge-target" style="background: var(--white); color: var(--primary-green); border: 1px solid var(--primary-green);">
                  ${categoryLabels[activity.category] || activity.category || 'General'}
                </span>
                ${activity.platform ? `<span style="color: var(--text-light); font-size: 0.85rem; display: flex; align-items: center; gap: 0.25rem;"><img src="/media/icons/Location128x128.png" alt="Location" style="width: 14px; height: 14px;"> ${activity.platform}</span>` : ''}
              </div>
            </div>
          </div>
          <button class="btn btn-secondary" onclick="removeSavedActivity(${activity.id})" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
            Remove
          </button>
        </div>
      `).join('');
    }

    function removeSavedActivity(activityId) {
      const saved = Storage.get('savedActivities', []).filter(a => a.id !== activityId);
      Storage.set('savedActivities', saved);
      loadSavedActivities();
      displayActivities(allActivities);
    }
  </script>
</body>
</html>

